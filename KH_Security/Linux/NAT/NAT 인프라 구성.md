# NAT 환경 구성 실습 (Rocky Linux 기반)

## 개요

- 본 문서는 Rocky Linux 최소 설치 환경에서  
  **다중 네트워크 구간 간 통신을 위한 NAT / 라우팅 실습**을 정리한 문서입니다.
- Linux → Router → Linux 구조를 구성하여 서로 다른 네트워크 간 통신이 가능하게 합니다.
- 방화벽, 커널 포워딩, SELinux, 라우팅 설정을 단계별로 확인합니다.

---

## 네트워크 구성 개요

- 사진 -

---

## Linux11 네트워크 설정

- 사진 -

- IP 주소 : 192.168.11.126 
- 서브넷 마스크 : 255.255.255.0  
- 게이트웨이 : 192.168.11.1  
- DNS : 8.8.8.8  

---

## Linux12 네트워크 설정

- 사진 - 

- IP 주소 : 192.168.12.126
- 서브넷 마스크 : 255.255.255.0  
- 게이트웨이 : 192.168.12.1
- DNS : 8.8.8.8  

---

## Router (ens160) 네트워크 설정

- 사진 -

- IP 주소 : 192.168.11.254
- 서브넷 마스크 : 255.255.255.0  
- 게이트웨이 : 192.168.11.1  
- DNS : 8.8.8.8  

---

## Router (ens###) 네트워크 설정

![02](/Linux/NAT%20configuration/imgs/02.png)

- IP 주소 : 192.168.12.1  
- 서브넷 마스크 : 255.255.255.0
- 게이트웨이 : X
- DNS : X

---

## firewalld 비활성화

```text
systemctl disable firewalld.service  
systemctl stop firewalld.service  
```
- 사진 -

- 위 두 명령어는 다음을 의미합니다.
  - 현재 실행 중인 firewalld 서비스를 중지합니다.
  - 시스템 재부팅 후에도 firewalld가 자동으로 실행되지 않도록 설정합니다.

---

## IP 포워딩 활성화

- Router 역할을 수행하기 위해 커널 IP 포워딩을 활성화합니다.
- ` vi /etc/sysctl.conf` 명령어를 통해서 파일에 다음 항목을 추가합니다.

`net.ipv4.ip_forward=1`

(사진)

- 이 설정은 해당 라우터에서 패킷을 Linux 12 네트워크 대역으로 보내기 위한 설정입니다.

---

## 커널 설정 즉시 적용

`sysctl -p`

- 사진 -

- `/etc/sysctl.conf`에 설정한 커널 옵션을  
  재부팅 없이 즉시 적용합니다.

---

## SELinux 비활성화

- `/etc/selinux/config` 파일을 수정합니다.
```text
SELINUX=disabled  
```
(사진)

- SELinux를 완전히 비활성화하여 커널 보안 정책으로 인한 통신 차단을 제거합니다.
- 해당 설정은 재부팅 후 적용됩니다.

---

## Windows (192.168.10.146) 라우팅 추가

- Windows PC에서  
  192.168.12.0/24 네트워크로 통신 가능하도록 라우팅 경로를 수동으로 추가합니다.

`route -p add 192.168.12.0 MASK 255.255.255.0 192.168.11.254`

(사진)

- -p 옵션의 의미
  - 시스템 재부팅 후에도 라우팅 정보를 유지합니다.

---

## Linux11 → Linux12 라우팅 추가

- Linux11에서 Linux12 네트워크로 통신 가능하도록 라우팅을 추가합니다.
- 추가를 해주어야 Linux11에서 Linux12로 패킷을 전송할 수 있습니다.

```text
ip route add 192.168.12.0/24 via 192.168.11.254 dev ens160  
```
(사진)

- ip route 확인 시  
  192.168.12.0/24 네트워크로 가는 경로가 정상적으로 추가된 것을 확인할 수 있습니다.

---

## 인터페이스 및 IP 상태 확인

### Linux11

(사진)

### Router

(사진)

### Linux12

(사진)

- 각 시스템의 인터페이스와 IP 상태가 정상임을 확인합니다.

---
